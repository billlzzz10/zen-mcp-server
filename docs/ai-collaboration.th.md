# การสนทนา AI-to-AI แบบมีเธรด

Zen MCP Server ทำให้ Claude สามารถร่วมมือกับโมเดลอื่น (Gemini, O3 ฯลฯ) เพื่อสืบค้นและวิเคราะห์ปัญหาที่ซับซ้อนได้อย่างแท้จริง

## หลักการทำงาน

**การประสานหลายโมเดล:**
- **Gemini ถาม Claude ต่อได้** เพื่อขอรายละเอียดหรือบริบทเพิ่ม
- **Claude ตอบกลับ** พร้อมไฟล์หรือคำแนะนำเพิ่มเติม
- **Claude ทำงานอิสระได้** ระหว่างรอตอบ เช่น ปรับโค้ด รวบรวมข้อมูล วิเคราะห์ผล
- **Claude แจ้งผลให้ Gemini** ต่อเนื่องเพื่อขอความเห็นเพิ่มเติม
- **สานต่อข้ามเครื่องมือ** – เริ่มจาก `analyze` แล้วต่อด้วย `codereview` ใน conversation เดียวกัน
- **ทุกโมเดลตั้งคำถามซึ่งกันและกัน** เพื่อตรวจสอบสมมติฐานและแนวทาง
- ระบบส่งเฉพาะข้อมูลใหม่ในแต่ละรอบ ทำให้ประหยัดบริบท
- Thread ของบทสนทนาถูกจัดเก็บและจัดการอัตโนมัติในช่วงเวลาที่ตั้งค่าไว้

## ตัวอย่างการประสานหลายโมเดล

**คำสั่ง:** "ถกเถียง SwiftUI vs UIKit ตัวไหนเหมาะกว่าสำหรับ iOS?"

1. คุณตั้งคำถาม
2. Claude (auto mode) แจ้งว่าจะเรียกหลายโมเดลมาถกกัน
3. Gemini Pro ชูจุดเด่น SwiftUI ด้านสถาปัตยกรรมและการจัดการ state
4. O3 ให้เหตุผลว่า UIKit มีเสถียรภาพและคุมรายละเอียดได้ละเอียดกว่า
5. Claude ขอความเห็นเพิ่มเติมจาก Flash เรื่องประสบการณ์นักพัฒนา
6. Gemini Flash แชร์ข้อดี SwiftUI/ UIKit แบบสั้น ๆ
7. Claude สรุปว่าขึ้นอยู่กับโจทย์: SwiftUI สำหรับงานใหม่เร่งด่วน UIKit สำหรับงานต้องควบคุมละเอียด

## ความสามารถแบบอะซิงโครนัส

- Claude ทำงานต่อเองได้ระหว่างรอ (เช่น แก้โค้ด, รวบรวมข้อมูล)
- กลับมารายงานผลพร้อมบริบทเพิ่มให้ Gemini ได้ทุกเมื่อ
- ส่งเฉพาะข้อมูลใหม่ในแต่ละรอบ บันทึกประวัติไว้ครบ
- เลี่ยงเพดาน 25K ของ MCP ด้วยการอัปเดตแบบ incremental

## ฟีเจอร์ความร่วมมือที่โดดเด่น

- **ถามค้านกันได้** – โมเดลทักท้วงหรือยืนยันสมมติฐานกันเอง
- **แก้ปัญหาร่วมกัน** – แต่ละโมเดลใช้จุดแข็งเพื่อสร้างทางออกที่ดีกว่า
- **Claude เก็บบริบทให้** – รวบรวมข้อมูล ส่งให้โมเดลลึกวิเคราะห์
- **ตรวจสอบแนวทาง** – โมเดลอื่นช่วยตรวจคำตอบก่อนลงมือจริง
- **สานต่อข้ามเครื่องมือ** – เปลี่ยนจากการวิเคราะห์ → รีวิว → ดีบัก โดยไม่เสียบริบท
- **เวิร์กโฟลว์อะซิงโครนัส** – ไม่ต้องคุยแบบต่อเนื่อง Claude ทำงานแทรกแล้วกลับมาเล่าได้
- **อัปเดตแบบ incremental** – ส่งเฉพาะข้อมูลใหม่แต่เก็บประวัติครบ
- **เลี่ยงขีดจำกัด 25K** – บันทึกบริบททุกขั้นที่ Zen ช่วยบริหารให้

## การตั้งค่าทางเทคนิค

- จำกัดรอบการสนทนา 10 ครั้ง (ปรับผ่าน `MAX_CONVERSATION_TURNS`)
- Thread หมดอายุภายใน 3 ชั่วโมง (ปรับผ่าน `CONVERSATION_TIMEOUT_HOURS`)
- บริหารผ่านหน่วยความจำร่วม ปลอดภัยกับการทำงานพร้อมกัน
- **เก็บภาพ** – ไฟล์ภาพที่แนบจะคงอยู่ระหว่างการสลับเครื่องมือ/โมเดล

## ตัวอย่างสานต่อข้ามเครื่องมือและโมเดล

```
1. Claude: "Analyze /src/auth.py"
   → Auto mode เลือก Gemini Pro เพื่อวิเคราะห์ความปลอดภัย

2. Claude: "Review authentication logic thoroughly"
   → ใช้ continuation เดิมแต่สลับไป O3 วิเคราะห์ตรรกะเชิงลึก

3. Claude: "Debug auth test failures"
   → คง continuation เดิม O3 ช่วยลงรายละเอียดดีบัก

4. Claude: "Quick style check"
   → เดิม thread เดิม แต่สลับไป Flash ตรวจสไตล์เร็ว ๆ
```

## ประโยชน์หลัก

- **มุมมองหลากหลาย** – แต่ละโมเดลเสนอแนวคิดคนละด้าน
- **บริบทไม่หาย** – เปลี่ยนเครื่องมือได้โดยไม่ต้องป้อนข้อมูลใหม่
- **สื่อสารมีประสิทธิภาพ** – ส่งเฉพาะสิ่งที่เปลี่ยนไป
- **วิเคราะห์เชิงลึก** – โมเดลต่อยอดจากกันได้ ไม่ทำงานโดดเดี่ยว
- **เวิร์กโฟลว์ลื่นไหล** – ย้ายระหว่าง analyze → review → debug ได้ต่อเนื่อง
- **แก้ปัญหาดีขึ้น** – การร่วมมือสร้างคำตอบที่ดีและมั่นใจยิ่งขึ้น

## แนวทางปฏิบัติที่ดี

- ปล่อยให้ Claude เป็นผู้ประสานและเลือกโมเดลที่เหมาะกับแต่ละงาน
- ใช้คำสั่ง continuation เพื่อสร้างบริบทยาวและลึก
- สลับเครื่องมือเมื่อเป้าหมายเปลี่ยน (วิเคราะห์ → แก้ไข → ตรวจ)
- ให้บริบท/ข้อกำหนดที่ชัดเจนเพื่อให้ทุกโมเดลเข้าใจเป้าหมายเดียวกัน
- เชื่อมั่นกระบวนการ: การถกกันของโมเดลช่วยให้ได้คำตอบที่คุณอาจไม่คิดมาก่อน

ดูรายละเอียดเพิ่มเติมเกี่ยวกับการรักษาบริบทได้ใน [Context Revival Guide](context-revival.md)
