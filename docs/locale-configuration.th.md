# การตั้งค่าภาษา (Locale) สำหรับ Zen MCP Server

คู่มือนี้อธิบายการตั้งค่าเพื่อให้เครื่องมือ MCP ตอบกลับเป็นภาษาที่ต้องการ โดยยังคงความสามารถด้านการวิเคราะห์ครบถ้วน

## ภาพรวม

- กำหนดภาษาได้ผ่านตัวแปร `LOCALE`
- เครื่องมือทุกตัวจะพยายามตอบในภาษานั้น
- เหมาะสำหรับผู้ที่ต้องการคำตอบเป็นภาษาท้องถิ่น

## การตั้งค่า

### 1. ตั้งค่าตัวแปรสภาพแวดล้อม

เพิ่มในไฟล์ `.env`:
```bash
LOCALE=fr-FR
```

### 2. ตัวอย่างรหัสภาษา (มาตรฐาน ISO)
- `fr-FR` – ฝรั่งเศส
- `en-US` – อังกฤษ (สหรัฐอเมริกา)
- `zh-CN` – จีนตัวย่อ
- `zh-TW` – จีนตัวเต็ม
- `ja-JP` – ญี่ปุ่น
- `ko-KR` – เกาหลี
- `es-ES` – สเปน
- `de-DE` – เยอรมนี
- `it-IT` – อิตาลี
- `pt-PT` – โปรตุเกส
- `ru-RU` – รัสเซีย
- `ar-SA` – อาหรับ (ซาอุฯ)

### 3. พฤติกรรมเริ่มต้น

หากไม่ตั้ง `LOCALE` ระบบจะตอบเป็นภาษาอังกฤษ

## การทำงานภายใน

### เมท็อด `get_language_instruction()`

อยู่ใน `tools/shared/base_tool.py`:
```python
def get_language_instruction(self) -> str:
    import os
    locale = os.getenv("LOCALE", "").strip()
    if not locale:
        return ""
    return f"Always respond in {locale}.\n\n"
```

คำสั่งนี้จะถูกเพิ่มไปที่ system prompt ของทุกเครื่องมือโดยอัตโนมัติ

## วิธีใช้งาน

1. ตั้งค่า `.env`:
   ```bash
   LOCALE=fr-FR
   ```
2. รีสตาร์ทเซิร์ฟเวอร์: `./run-server.sh`
3. ใช้เครื่องมือใด ๆ คำตอบจะเป็นภาษาที่ตั้งไว้

**ตัวอย่าง:**
- ก่อนตั้งค่า: ตรวจ dict ใน Python → คำตอบภาษาอังกฤษ
- หลังตั้ง `LOCALE=fr-FR`: คำตอบเดียวกันแต่เป็นภาษาฝรั่งเศส

## เครื่องมือที่ได้รับผล

ทุกเครื่องมือ เช่น `chat`, `codereview`, `analyze`, `debug`, `refactor`, `thinkdeep`, `consensus` ฯลฯ

## แนวทางแนะนำ

- ใช้รหัสภาษาตามมาตรฐาน (ISO-639 + ISO-3166)
- หากทำงานเป็นทีม ให้ตกลงภาษาที่จะใช้ร่วมกัน
- ลองทดสอบกับเครื่องมือหลายตัวเพื่อให้แน่ใจว่าการตั้งค่ามีผลจริง

## การแก้ปัญหา

- **ภาษาไม่เปลี่ยน**: ตรวจค่า `LOCALE` ใน `.env`, รีสตาร์ทเซิร์ฟเวอร์, ลบช่องว่างที่เกิน
- **ตอบสองภาษา**: ขึ้นอยู่กับโมเดล บางจุดอาจยังใช้คำอังกฤษ (โดยเฉพาะศัพท์เทคนิค)
- **ค่า `.env` ผิด**: ตรวจว่าไม่มีเครื่องหมายคำพูดล้อมรอบค่า

## การปรับแต่งขั้นสูง

- แก้เมท็อด `get_language_instruction()` เพื่อเพิ่มรายละเอียด เช่น โทนภาษาหรือคำสั่งเฉพาะ
- Override เมท็อดในเครื่องมือเฉพาะเพื่อให้ตอบต่างกันตาม locale

## การทำงานร่วมกับฟีเจอร์อื่น

Localization ใช้งานร่วมกับฟีเจอร์อื่นได้ครบ:
- การต่อบทสนทนา (conversation threading)
- การประมวลผลไฟล์
- การสลับโมเดลอัตโนมัติ
- การค้นเว็บ